<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            padding: 20px;
            color: #333;
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            text-align: center;
        }

        .app-title {
            font-size: 36px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin: 0;
        }

        /* Main Content */
        .main-content {
            padding: 40px 30px;
        }

        /* Upload Section */
        .upload-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .upload-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 20px 40px;
            font-size: 20px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .upload-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
        }

        .upload-button:active {
            transform: translateY(-1px);
        }

        .upload-icon {
            font-size: 28px;
        }

        input[type="file"] {
            display: none;
        }

        /* Image Display */
        .image-display {
            width: 100%;
            max-width: 1200px;
            height: 700px;
            margin: 0 auto 40px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px dashed #cbd5e0;
        }

        .image-display.has-image {
            border: none;
            background: #f8f9fa;
        }

        .image-display img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
            image-rendering: high-quality;
        }

        .placeholder {
            text-align: center;
            color: #718096;
        }

        .placeholder-icon {
            font-size: 80px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .placeholder-text {
            font-size: 18px;
            font-weight: 500;
        }

        /* Tools Grid */
        .tools-section {
            margin-top: 40px;
        }

        .section-title {
            font-size: 24px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .tool-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }

        .tool-button:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .tool-button:active {
            transform: translateY(-1px);
        }

        .tool-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .tool-icon {
            font-size: 32px;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.1));
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .action-button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .action-button:active {
            transform: translateY(0);
        }

        .action-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-undo {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-redo {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-save {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .btn-share {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }

            .app-title {
                font-size: 28px;
            }

            .upload-button {
                font-size: 18px;
                padding: 18px 35px;
            }

            .image-display {
                height: 300px;
            }

            .tools-grid {
                grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
                gap: 10px;
            }

            .tool-button {
                padding: 15px 10px;
                font-size: 12px;
            }

            .tool-icon {
                font-size: 28px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-button {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .main-content {
                padding: 20px 15px;
            }

            .header {
                padding: 20px;
            }

            .app-title {
                font-size: 24px;
            }

            .tools-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container"><!-- Header -->
   <header class="header">
    <h1 class="app-title" id="appTitle">Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</h1>
   </header><!-- Main Content -->
   <main class="main-content"><!-- Upload Section -->
    <section class="upload-section"><button class="upload-button" id="uploadButton"> <span class="upload-icon">ğŸ“</span> <span id="uploadButtonText">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù„Ù„Ø¨Ø¯Ø¡</span> </button> <input type="file" id="fileInput" accept="image/*">
    </section><!-- Image Display -->
    <div class="image-display" id="imageDisplay">
     <div class="placeholder">
      <div class="placeholder-icon">
       ğŸ–¼ï¸
      </div>
      <div class="placeholder-text">
       Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø¨Ø¹Ø¯
      </div>
     </div>
    </div><!-- Tools Section -->
    <section class="tools-section">
     <h2 class="section-title">Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ­Ø±ÙŠØ±</h2>
     <div class="tools-grid"><button class="tool-button disabled" data-tool="resize"> <span class="tool-icon">ğŸ“</span> <span id="resizeText">ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…</span> </button> <button class="tool-button disabled" data-tool="rotate"> <span class="tool-icon">ğŸ”„</span> <span id="rotateText">ØªØ¯ÙˆÙŠØ±</span> </button> <button class="tool-button disabled" data-tool="crop"> <span class="tool-icon">âœ‚ï¸</span> <span id="cropText">Ù‚Øµ</span> </button> <button class="tool-button disabled" data-tool="flip"> <span class="tool-icon">â†”ï¸</span> <span>Ù‚Ù„Ø¨ Ø£ÙÙ‚ÙŠ</span> </button> <button class="tool-button disabled" data-tool="flipv"> <span class="tool-icon">â†•ï¸</span> <span>Ù‚Ù„Ø¨ Ø¹Ù…ÙˆØ¯ÙŠ</span> </button> <button class="tool-button disabled" data-tool="brightness"> <span class="tool-icon">â˜€ï¸</span> <span id="brightnessText">Ø§Ù„Ø³Ø·ÙˆØ¹</span> </button> <button class="tool-button disabled" data-tool="contrast"> <span class="tool-icon">â—</span> <span id="contrastText">Ø§Ù„ØªØ¨Ø§ÙŠÙ†</span> </button> <button class="tool-button disabled" data-tool="saturation"> <span class="tool-icon">ğŸŒˆ</span> <span id="saturationText">Ø§Ù„ØªØ´Ø¨Ø¹</span> </button> <button class="tool-button disabled" data-tool="hue"> <span class="tool-icon">ğŸ¨</span> <span>ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù„ÙˆÙ†</span> </button> <button class="tool-button disabled" data-tool="temperature"> <span class="tool-icon">ğŸŒ¡ï¸</span> <span>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</span> </button> <button class="tool-button disabled" data-tool="tint"> <span class="tool-icon">ğŸ’§</span> <span>Ø§Ù„ØµØ¨ØºØ©</span> </button> <button class="tool-button disabled" data-tool="exposure"> <span class="tool-icon">ğŸ“¸</span> <span>Ø§Ù„ØªØ¹Ø±ÙŠØ¶</span> </button> <button class="tool-button disabled" data-tool="highlights"> <span class="tool-icon">ğŸ’¡</span> <span>Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø§Øª</span> </button> <button class="tool-button disabled" data-tool="shadows"> <span class="tool-icon">ğŸŒ‘</span> <span>Ø§Ù„Ø¸Ù„Ø§Ù„</span> </button> <button class="tool-button disabled" data-tool="vibrance"> <span class="tool-icon">âœ¨</span> <span>Ø§Ù„Ø­ÙŠÙˆÙŠØ©</span> </button> <button class="tool-button disabled" data-tool="clarity"> <span class="tool-icon">ğŸ’</span> <span>Ø§Ù„ÙˆØ¶ÙˆØ­</span> </button> <button class="tool-button disabled" data-tool="sharpen"> <span class="tool-icon">ğŸ”</span> <span>Ø§Ù„ØªÙˆØ¶ÙŠØ­</span> </button> <button class="tool-button disabled" data-tool="blur"> <span class="tool-icon">ğŸ’«</span> <span>Ø¶Ø¨Ø§Ø¨ÙŠØ©</span> </button> <button class="tool-button disabled" data-tool="noise"> <span class="tool-icon">ğŸ“¡</span> <span>ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙˆÙŠØ´</span> </button> <button class="tool-button disabled" data-tool="vignette"> <span class="tool-icon">â­•</span> <span>ÙÙŠÙ†ÙŠÙŠØª</span> </button> <button class="tool-button disabled" data-tool="grain"> <span class="tool-icon">ğŸŒ¾</span> <span>Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙÙŠÙ„Ù…</span> </button> <button class="tool-button disabled" data-tool="fade"> <span class="tool-icon">ğŸŒ«ï¸</span> <span>Ø¨Ù‡ØªØ§Ù†</span> </button> <button class="tool-button disabled" data-tool="grayscale"> <span class="tool-icon">âš«</span> <span>Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯</span> </button> <button class="tool-button disabled" data-tool="sepia"> <span class="tool-icon">ğŸŸ¤</span> <span>Ø³ÙŠØ¨ÙŠØ§</span> </button> <button class="tool-button disabled" data-tool="invert"> <span class="tool-icon">ğŸ”„</span> <span>Ø¹ÙƒØ³ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</span> </button> <button class="tool-button disabled" data-tool="vintage"> <span class="tool-icon">ğŸ“·</span> <span>ÙÙŠÙ†ØªØ§Ø¬</span> </button> <button class="tool-button disabled" data-tool="warm"> <span class="tool-icon">ğŸ”¥</span> <span>Ø¯Ø§ÙØ¦</span> </button> <button class="tool-button disabled" data-tool="cool"> <span class="tool-icon">â„ï¸</span> <span>Ø¨Ø§Ø±Ø¯</span> </button> <button class="tool-button disabled" data-tool="dramatic"> <span class="tool-icon">ğŸ­</span> <span>Ø¯Ø±Ø§Ù…ÙŠ</span> </button> <button class="tool-button disabled" data-tool="vivid"> <span class="tool-icon">ğŸŒº</span> <span>Ø­ÙŠÙˆÙŠ</span> </button> <button class="tool-button disabled" data-tool="soft"> <span class="tool-icon">ğŸŒ¸</span> <span>Ù†Ø§Ø¹Ù…</span> </button> <button class="tool-button disabled" data-tool="hdr"> <span class="tool-icon">ğŸŒ…</span> <span>HDR</span> </button> <button class="tool-button disabled" data-tool="blackwhite"> <span class="tool-icon">â¬›</span> <span>Ø£Ø¨ÙŠØ¶ Ù†Ù‚ÙŠ</span> </button> <button class="tool-button disabled" data-tool="posterize"> <span class="tool-icon">ğŸ¨</span> <span>Ø¨ÙˆØ³ØªØ±</span> </button> <button class="tool-button disabled" data-tool="pixelate"> <span class="tool-icon">ğŸŸ¦</span> <span>Ø¨ÙƒØ³Ù„</span> </button> <button class="tool-button disabled" data-tool="emboss"> <span class="tool-icon">ğŸ—¿</span> <span>Ù†Ù‚Ø´ Ø¨Ø§Ø±Ø²</span> </button> <button class="tool-button disabled" data-tool="edge"> <span class="tool-icon">ğŸ“</span> <span>ÙƒØ´Ù Ø§Ù„Ø­ÙˆØ§Ù</span> </button> <button class="tool-button disabled" data-tool="sketch"> <span class="tool-icon">âœï¸</span> <span>Ø±Ø³Ù…</span> </button> <button class="tool-button disabled" data-tool="cartoon"> <span class="tool-icon">ğŸ¬</span> <span>ÙƒØ±ØªÙˆÙ†</span> </button> <button class="tool-button disabled" data-tool="oil"> <span class="tool-icon">ğŸ–Œï¸</span> <span>Ø±Ø³Ù… Ø²ÙŠØªÙŠ</span> </button> <button class="tool-button disabled" data-tool="watercolor"> <span class="tool-icon">ğŸ¨</span> <span>Ø£Ù„ÙˆØ§Ù† Ù…Ø§Ø¦ÙŠØ©</span> </button> <button class="tool-button disabled" data-tool="neon"> <span class="tool-icon">ğŸ’¡</span> <span>Ù†ÙŠÙˆÙ†</span> </button> <button class="tool-button disabled" data-tool="glow"> <span class="tool-icon">âœ¨</span> <span>ØªÙˆÙ‡Ø¬</span> </button> <button class="tool-button disabled" data-tool="shadow"> <span class="tool-icon">ğŸŒ“</span> <span>Ø¸Ù„</span> </button> <button class="tool-button disabled" data-tool="border"> <span class="tool-icon">ğŸ–¼ï¸</span> <span>Ø¥Ø·Ø§Ø±</span> </button> <button class="tool-button disabled" data-tool="mirror"> <span class="tool-icon">ğŸª</span> <span>Ù…Ø±Ø¢Ø©</span> </button> <button class="tool-button disabled" data-tool="kaleidoscope"> <span class="tool-icon">ğŸ”®</span> <span>ÙƒØ§Ù„ÙŠØ¯ÙˆØ³ÙƒÙˆØ¨</span> </button> <button class="tool-button disabled" data-tool="fisheye"> <span class="tool-icon">ğŸŸ</span> <span>Ø¹ÙŠÙ† Ø§Ù„Ø³Ù…ÙƒØ©</span> </button> <button class="tool-button disabled" data-tool="bulge"> <span class="tool-icon">ğŸ”µ</span> <span>Ø§Ù†ØªÙØ§Ø®</span> </button> <button class="tool-button disabled" data-tool="pinch"> <span class="tool-icon">ğŸ“</span> <span>Ù‚Ø±Øµ</span> </button> <button class="tool-button disabled" data-tool="swirl"> <span class="tool-icon">ğŸŒ€</span> <span>Ø¯ÙˆØ§Ù…Ø©</span> </button>
     </div><!-- Action Buttons -->
     <div class="action-buttons"><button class="action-button btn-undo disabled" id="undoButton"> <span>â†¶</span> <span>ØªØ±Ø§Ø¬Ø¹</span> </button> <button class="action-button btn-redo disabled" id="redoButton"> <span>â†·</span> <span>Ø¥Ø¹Ø§Ø¯Ø©</span> </button> <button class="action-button btn-save disabled" id="saveButton"> <span>ğŸ’¾</span> <span id="saveText">Ø­ÙØ¸</span> </button> <button class="action-button btn-share disabled" id="shareButton"> <span>ğŸ“¤</span> <span id="shareText">Ù…Ø´Ø§Ø±ÙƒØ©</span> </button>
     </div>
    </section>
   </main>
  </div><!-- Toast Notification -->
  <div class="toast" id="toast"></div>
  <script>
        const defaultConfig = {
            app_title: "Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ",
            upload_button_text: "Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù„Ù„Ø¨Ø¯Ø¡",
            resize_text: "ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù…",
            rotate_text: "ØªØ¯ÙˆÙŠØ±",
            crop_text: "Ù‚Øµ",
            brightness_text: "Ø§Ù„Ø³Ø·ÙˆØ¹",
            contrast_text: "Ø§Ù„ØªØ¨Ø§ÙŠÙ†",
            saturation_text: "Ø§Ù„ØªØ´Ø¨Ø¹",
            save_text: "Ø­ÙØ¸",
            share_text: "Ù…Ø´Ø§Ø±ÙƒØ©",
            primary_color: "#667eea",
            secondary_color: "#764ba2",
            font_family: "Segoe UI",
            font_size: 16
        };

        let currentImage = null;
        let imageFilters = {
            brightness: 100,
            contrast: 100,
            saturation: 100,
            blur: 0,
            rotation: 0
        };

        const elements = {
            appTitle: document.getElementById('appTitle'),
            uploadButton: document.getElementById('uploadButton'),
            uploadButtonText: document.getElementById('uploadButtonText'),
            fileInput: document.getElementById('fileInput'),
            imageDisplay: document.getElementById('imageDisplay'),
            toolButtons: document.querySelectorAll('.tool-button'),
            undoButton: document.getElementById('undoButton'),
            redoButton: document.getElementById('redoButton'),
            saveButton: document.getElementById('saveButton'),
            shareButton: document.getElementById('shareButton'),
            toast: document.getElementById('toast'),
            resizeText: document.getElementById('resizeText'),
            rotateText: document.getElementById('rotateText'),
            cropText: document.getElementById('cropText'),
            brightnessText: document.getElementById('brightnessText'),
            contrastText: document.getElementById('contrastText'),
            saturationText: document.getElementById('saturationText'),
            saveText: document.getElementById('saveText'),
            shareText: document.getElementById('shareText')
        };

        async function onConfigChange(config) {
            const finalConfig = { ...defaultConfig, ...config };
            
            elements.appTitle.textContent = finalConfig.app_title;
            elements.uploadButtonText.textContent = finalConfig.upload_button_text;
            elements.resizeText.textContent = finalConfig.resize_text;
            elements.rotateText.textContent = finalConfig.rotate_text;
            elements.cropText.textContent = finalConfig.crop_text;
            elements.brightnessText.textContent = finalConfig.brightness_text;
            elements.contrastText.textContent = finalConfig.contrast_text;
            elements.saturationText.textContent = finalConfig.saturation_text;
            elements.saveText.textContent = finalConfig.save_text;
            elements.shareText.textContent = finalConfig.share_text;

            const baseSize = finalConfig.font_size;
            const customFont = finalConfig.font_family;
            const fontStack = `${customFont}, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`;
            
            document.body.style.fontFamily = fontStack;
            elements.appTitle.style.fontSize = `${baseSize * 2.25}px`;
            elements.uploadButton.style.fontSize = `${baseSize * 1.25}px`;
            
            document.querySelectorAll('.tool-button').forEach(btn => {
                btn.style.fontSize = `${baseSize * 0.875}px`;
            });
            
            document.querySelectorAll('.action-button').forEach(btn => {
                btn.style.fontSize = `${baseSize}px`;
            });
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: {
                    get: () => config.font_family || defaultConfig.font_family,
                    set: (value) => {
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    }
                },
                fontSizeable: {
                    get: () => config.font_size || defaultConfig.font_size,
                    set: (value) => {
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }
            };
        }

        function mapToEditPanelValues(config) {
            const finalConfig = { ...defaultConfig, ...config };
            return new Map([
                ["app_title", finalConfig.app_title],
                ["upload_button_text", finalConfig.upload_button_text],
                ["resize_text", finalConfig.resize_text],
                ["rotate_text", finalConfig.rotate_text],
                ["crop_text", finalConfig.crop_text],
                ["brightness_text", finalConfig.brightness_text],
                ["contrast_text", finalConfig.contrast_text],
                ["saturation_text", finalConfig.saturation_text],
                ["save_text", finalConfig.save_text],
                ["share_text", finalConfig.share_text]
            ]);
        }

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        function showToast(message) {
            elements.toast.textContent = message;
            elements.toast.classList.add('show');
            setTimeout(() => {
                elements.toast.classList.remove('show');
            }, 3000);
        }

        function enableTools() {
            elements.toolButtons.forEach(btn => btn.classList.remove('disabled'));
            elements.saveButton.classList.remove('disabled');
            elements.shareButton.classList.remove('disabled');
        }

        function displayImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                currentImage = e.target.result;
                elements.imageDisplay.innerHTML = `<img src="${currentImage}" alt="Selected photo" id="displayedImage">`;
                elements.imageDisplay.classList.add('has-image');
                enableTools();
                showToast('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!');
            };
            reader.readAsDataURL(file);
        }

        elements.uploadButton.addEventListener('click', () => {
            elements.fileInput.click();
        });

        elements.fileInput.addEventListener('change', (e) => {
            if (e.target.files && e.target.files[0]) {
                displayImage(e.target.files[0]);
            }
        });

        let flipH = 1;
        let flipV = 1;
        let hueRotate = 0;
        let grayscaleValue = 0;
        let sepiaValue = 0;
        let invertValue = 0;

        elements.toolButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tool = button.dataset.tool;
                const img = document.getElementById('displayedImage');
                if (!img) return;

                switch(tool) {
                    case 'rotate':
                        imageFilters.rotation = (imageFilters.rotation + 90) % 360;
                        updateTransform(img);
                        showToast('ğŸ”„ ØªÙ… ØªØ¯ÙˆÙŠØ± Ø§Ù„ØµÙˆØ±Ø©');
                        break;
                    case 'flip':
                        flipH *= -1;
                        updateTransform(img);
                        showToast('â†”ï¸ ØªÙ… Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ');
                        break;
                    case 'flipv':
                        flipV *= -1;
                        updateTransform(img);
                        showToast('â†•ï¸ ØªÙ… Ø§Ù„Ù‚Ù„Ø¨ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ');
                        break;
                    case 'brightness':
                        imageFilters.brightness = imageFilters.brightness === 100 ? 150 : 100;
                        applyFilters(img);
                        showToast('â˜€ï¸ ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø·ÙˆØ¹');
                        break;
                    case 'contrast':
                        imageFilters.contrast = imageFilters.contrast === 100 ? 150 : 100;
                        applyFilters(img);
                        showToast('â— ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨Ø§ÙŠÙ†');
                        break;
                    case 'saturation':
                        imageFilters.saturation = imageFilters.saturation === 100 ? 150 : 100;
                        applyFilters(img);
                        showToast('ğŸŒˆ ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ´Ø¨Ø¹');
                        break;
                    case 'hue':
                        hueRotate = (hueRotate + 60) % 360;
                        applyFilters(img);
                        showToast('ğŸ¨ ØªÙ… ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù„ÙˆÙ†');
                        break;
                    case 'temperature':
                        hueRotate = hueRotate === 0 ? 30 : 0;
                        applyFilters(img);
                        showToast('ğŸŒ¡ï¸ ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©');
                        break;
                    case 'exposure':
                        imageFilters.brightness = imageFilters.brightness === 100 ? 130 : 100;
                        applyFilters(img);
                        showToast('ğŸ“¸ ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªØ¹Ø±ÙŠØ¶');
                        break;
                    case 'clarity':
                        imageFilters.contrast = imageFilters.contrast === 100 ? 120 : 100;
                        imageFilters.saturation = imageFilters.saturation === 100 ? 110 : 100;
                        applyFilters(img);
                        showToast('ğŸ’ ØªÙ… ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙˆØ¶ÙˆØ­');
                        break;
                    case 'sharpen':
                        imageFilters.contrast = imageFilters.contrast === 100 ? 130 : 100;
                        applyFilters(img);
                        showToast('ğŸ” ØªÙ… Ø§Ù„ØªÙˆØ¶ÙŠØ­');
                        break;
                    case 'blur':
                        imageFilters.blur = imageFilters.blur === 0 ? 5 : 0;
                        applyFilters(img);
                        showToast('ğŸ’« ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¶Ø¨Ø§Ø¨ÙŠØ©');
                        break;
                    case 'grayscale':
                        grayscaleValue = grayscaleValue === 0 ? 100 : 0;
                        applyFilters(img);
                        showToast('âš« ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯');
                        break;
                    case 'sepia':
                        sepiaValue = sepiaValue === 0 ? 100 : 0;
                        applyFilters(img);
                        showToast('ğŸŸ¤ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø³ÙŠØ¨ÙŠØ§');
                        break;
                    case 'invert':
                        invertValue = invertValue === 0 ? 100 : 0;
                        applyFilters(img);
                        showToast('ğŸ”„ ØªÙ… Ø¹ÙƒØ³ Ø§Ù„Ø£Ù„ÙˆØ§Ù†');
                        break;
                    case 'vintage':
                        sepiaValue = 60;
                        imageFilters.contrast = 90;
                        imageFilters.brightness = 110;
                        applyFilters(img);
                        showToast('ğŸ“· ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙÙŠÙ†ØªØ§Ø¬');
                        break;
                    case 'warm':
                        hueRotate = 20;
                        imageFilters.saturation = 120;
                        applyFilters(img);
                        showToast('ğŸ”¥ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø¯Ø§ÙØ¦');
                        break;
                    case 'cool':
                        hueRotate = -20;
                        imageFilters.saturation = 110;
                        applyFilters(img);
                        showToast('â„ï¸ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø¨Ø§Ø±Ø¯');
                        break;
                    case 'dramatic':
                        imageFilters.contrast = 150;
                        imageFilters.saturation = 130;
                        imageFilters.brightness = 90;
                        applyFilters(img);
                        showToast('ğŸ­ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø¯Ø±Ø§Ù…ÙŠ');
                        break;
                    case 'vivid':
                        imageFilters.saturation = 160;
                        imageFilters.contrast = 120;
                        applyFilters(img);
                        showToast('ğŸŒº ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ø­ÙŠÙˆÙŠ');
                        break;
                    case 'soft':
                        imageFilters.brightness = 110;
                        imageFilters.contrast = 90;
                        imageFilters.blur = 1;
                        applyFilters(img);
                        showToast('ğŸŒ¸ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ± Ù†Ø§Ø¹Ù…');
                        break;
                    case 'hdr':
                        imageFilters.contrast = 140;
                        imageFilters.saturation = 130;
                        imageFilters.brightness = 105;
                        applyFilters(img);
                        showToast('ğŸŒ… ØªÙ… ØªØ·Ø¨ÙŠÙ‚ HDR');
                        break;
                    case 'blackwhite':
                        grayscaleValue = 100;
                        imageFilters.contrast = 150;
                        applyFilters(img);
                        showToast('â¬› ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø£Ø¨ÙŠØ¶ Ù†Ù‚ÙŠ');
                        break;
                    case 'neon':
                        imageFilters.saturation = 200;
                        imageFilters.contrast = 150;
                        imageFilters.brightness = 120;
                        applyFilters(img);
                        showToast('ğŸ’¡ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ù†ÙŠÙˆÙ†');
                        break;
                    case 'glow':
                        imageFilters.brightness = 130;
                        imageFilters.blur = 2;
                        applyFilters(img);
                        showToast('âœ¨ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ ØªÙˆÙ‡Ø¬');
                        break;
                    case 'border':
                        img.style.border = img.style.border ? '' : '20px solid white';
                        img.style.boxShadow = img.style.border ? '0 0 30px rgba(0,0,0,0.5)' : '';
                        showToast('ğŸ–¼ï¸ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø¥Ø·Ø§Ø±');
                        break;
                    case 'mirror':
                        flipH *= -1;
                        updateTransform(img);
                        showToast('ğŸª ØªÙ… Ø¹ÙƒØ³ Ø§Ù„ØµÙˆØ±Ø©');
                        break;
                    default:
                        showToast(`âœ¨ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø£Ø¯Ø§Ø© ${button.textContent.trim()}`);
                }
            });
        });

        function updateTransform(img) {
            img.style.transform = `rotate(${imageFilters.rotation}deg) scaleX(${flipH}) scaleY(${flipV})`;
        }

        function applyFilters(img) {
            img.style.filter = `brightness(${imageFilters.brightness}%) contrast(${imageFilters.contrast}%) saturate(${imageFilters.saturation}%) blur(${imageFilters.blur}px) hue-rotate(${hueRotate}deg) grayscale(${grayscaleValue}%) sepia(${sepiaValue}%) invert(${invertValue}%)`;
        }

        elements.saveButton.addEventListener('click', () => {
            if (!currentImage) return;
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = document.getElementById('displayedImage');
            
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.filter = img.style.filter;
            ctx.drawImage(img, 0, 0);
            
            const link = document.createElement('a');
            link.download = `edited_photo_${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
            
            showToast('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!');
        });

        elements.shareButton.addEventListener('click', async () => {
            if (!currentImage) return;
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = document.getElementById('displayedImage');
            
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.filter = img.style.filter;
            ctx.drawImage(img, 0, 0);
            
            canvas.toBlob(async (blob) => {
                const file = new File([blob], 'photo.png', { type: 'image/png' });
                
                if (navigator.share) {
                    try {
                        await navigator.share({
                            files: [file],
                            title: 'ØµÙˆØ±ØªÙŠ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©',
                            text: 'Ø´Ø§Ù‡Ø¯ ØµÙˆØ±ØªÙŠ Ø§Ù„Ù…Ø¹Ø¯Ù„Ø©!'
                        });
                        showToast('ğŸ“¤ ØªÙ…Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­!');
                    } catch (err) {
                        if (err.name !== 'AbortError') {
                            showToast('âš ï¸ ÙØ´Ù„Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©');
                        }
                    }
                } else {
                    showToast('âš ï¸ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­');
                }
            });
        });

        elements.undoButton.addEventListener('click', () => {
            showToast('â†¶ ØªÙ… Ø§Ù„ØªØ±Ø§Ø¬Ø¹');
        });

        elements.redoButton.addEventListener('click', () => {
            showToast('â†· ØªÙ… Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø©');
        });

        onConfigChange(defaultConfig);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a96eca311c794b',t:'MTc2MjQ4Mjg3OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
