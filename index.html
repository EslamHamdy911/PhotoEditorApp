<!doctype html>
<html lang="ar" dir="rtl">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            padding: 20px;
            color: #333;
        }

        html {
            height: 100%;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            text-align: center;
        }

        .app-title {
            font-size: 36px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            margin: 0;
        }

        /* Main Content */
        .main-content {
            padding: 40px 30px;
        }

        /* Upload Section */
        .upload-section {
            text-align: center;
            margin-bottom: 40px;
        }

        .upload-button {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            padding: 20px 40px;
            font-size: 20px;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .upload-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(102, 126, 234, 0.5);
        }

        .upload-button:active {
            transform: translateY(-1px);
        }

        .upload-icon {
            font-size: 28px;
        }

        input[type="file"] {
            display: none;
        }

        /* Image Display */
        .image-display {
            width: 100%;
            max-width: 1200px;
            height: 50%;
            min-height: 400px;
            margin: 0 auto 40px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border: 3px dashed #cbd5e0;
        }

        .image-display.has-image {
            border: none;
            background: #f8f9fa;
        }

        .image-display img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
            image-rendering: high-quality;
        }

        .placeholder {
            text-align: center;
            color: #718096;
        }

        .placeholder-icon {
            font-size: 80px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .placeholder-text {
            font-size: 18px;
            font-weight: 500;
        }

        /* Tools Section */
        .tools-section {
            margin-top: 40px;
        }

        .section-title {
            font-size: 28px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 20px;
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Tabs Container */
        .tabs-container {
            margin: 30px 0 20px 0;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .tabs-scroll {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 5px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: #667eea #e9ecef;
        }

        .tabs-scroll::-webkit-scrollbar {
            height: 6px;
        }

        .tabs-scroll::-webkit-scrollbar-track {
            background: #e9ecef;
            border-radius: 10px;
        }

        .tabs-scroll::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        .tab-button {
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 15px 20px;
            background: white;
            border: 2px solid transparent;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
            position: relative;
        }

        .tab-button:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
        }

        .tab-button:hover .tab-icon,
        .tab-button:hover .tab-label,
        .tab-button:hover .tab-count {
            color: white;
        }

        .tab-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-color: #667eea;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .tab-button.active .tab-icon,
        .tab-button.active .tab-label,
        .tab-button.active .tab-count {
            color: white;
        }

        .tab-icon {
            font-size: 28px;
            transition: all 0.3s ease;
        }

        .tab-label {
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab-count {
            position: absolute;
            top: 8px;
            left: 8px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-size: 11px;
            font-weight: 700;
            padding: 3px 8px;
            border-radius: 12px;
            min-width: 20px;
            text-align: center;
        }

        /* Tools Content */
        .tools-content {
            position: relative;
            min-height: 150px;
        }

        .tools-panel {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tools-panel.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tools-scroll {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 20px 5px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: #667eea #e9ecef;
        }

        .tools-scroll::-webkit-scrollbar {
            height: 8px;
        }

        .tools-scroll::-webkit-scrollbar-track {
            background: #f8f9fa;
            border-radius: 10px;
        }

        .tools-scroll::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
        }

        .tool-button {
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
            min-width: 110px;
        }

        .tool-button:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .tool-button:active {
            transform: translateY(-1px);
        }

        .tool-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .tool-button.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        .tool-icon {
            font-size: 32px;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.1));
        }

        /* Control Panel */
        .control-panel {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.98) 0%, rgba(255,255,255,1) 100%);
            padding: 20px;
            box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.2);
            transform: translateY(100%);
            transition: transform 0.4s ease;
            z-index: 2000;
            border-top-left-radius: 30px;
            border-top-right-radius: 30px;
            max-height: 35%;
            overflow-y: auto;
        }

        .control-panel.active {
            transform: translateY(0);
        }

        .control-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .control-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .close-control {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(245, 87, 108, 0.3);
        }

        .close-control:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 6px 20px rgba(245, 87, 108, 0.4);
        }

        .control-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .slider-container {
            margin-bottom: 25px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            font-size: 16px;
            font-weight: 600;
            color: #4a5568;
        }

        .slider-value {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 700;
            min-width: 60px;
            text-align: center;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 10px;
            background: linear-gradient(to right, #e2e8f0 0%, #cbd5e0 100%);
            outline: none;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
        }

        .slider::-moz-range-thumb:hover {
            transform: scale(1.2);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .control-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 15px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-reset {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(240, 147, 251, 0.4);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .action-button {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .action-button:active {
            transform: translateY(0);
        }

        .action-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-save {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }

        .btn-reset-all {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-share {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: 3000;
            backdrop-filter: blur(10px);
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Canvas for advanced effects */
        .canvas-container {
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                border-radius: 0;
            }

            .app-title {
                font-size: 28px;
            }

            .upload-button {
                font-size: 18px;
                padding: 18px 35px;
            }

            .image-display {
                height: 45%;
                min-height: 300px;
                margin-bottom: 20px;
            }

            .tabs-container {
                margin: 20px 0 15px 0;
                padding: 8px;
            }

            .tabs-scroll {
                gap: 8px;
            }

            .tab-button {
                min-width: 85px;
                padding: 12px 15px;
                gap: 6px;
            }

            .tab-icon {
                font-size: 24px;
            }

            .tab-label {
                font-size: 12px;
            }

            .tab-count {
                font-size: 10px;
                padding: 2px 6px;
                top: 6px;
                left: 6px;
            }

            .tools-scroll {
                gap: 10px;
                padding: 15px 5px;
            }

            .tool-button {
                min-width: 95px;
                padding: 15px 10px;
                font-size: 12px;
            }

            .tool-icon {
                font-size: 28px;
            }

            .control-panel {
                padding: 15px;
                max-height: 40%;
            }

            .control-title {
                font-size: 18px;
            }

            .control-header {
                margin-bottom: 15px;
            }

            .slider-container {
                margin-bottom: 15px;
            }

            .action-buttons {
                flex-direction: row;
                gap: 10px;
            }

            .action-button {
                flex: 1;
                justify-content: center;
                padding: 12px 20px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .main-content {
                padding: 20px 15px;
            }

            .header {
                padding: 20px;
            }

            .app-title {
                font-size: 24px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container"><!-- Header -->
   <header class="header">
    <h1 class="app-title" id="appTitle">Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</h1>
   </header><!-- Main Content -->
   <main class="main-content"><!-- Upload Section -->
    <section class="upload-section"><button class="upload-button" id="uploadButton"> <span class="upload-icon">ğŸ“</span> <span id="uploadButtonText">Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù„Ù„Ø¨Ø¯Ø¡</span> </button> <input type="file" id="fileInput" accept="image/*">
    </section><!-- Image Display -->
    <div class="image-display" id="imageDisplay">
     <div class="placeholder">
      <div class="placeholder-icon">
       ğŸ–¼ï¸
      </div>
      <div class="placeholder-text">
       Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø¨Ø¹Ø¯
      </div>
     </div>
    </div><!-- Canvas for advanced effects -->
    <div class="canvas-container">
     <canvas id="effectCanvas"></canvas>
    </div><!-- Tools Section -->
    <section class="tools-section">
     <h2 class="section-title">ğŸ¨ 50+ Ø£Ø¯Ø§Ø© ØªØ­Ø±ÙŠØ± Ø§Ø­ØªØ±Ø§ÙÙŠØ©</h2><!-- Tabs Navigation -->
     <div class="tabs-container">
      <div class="tabs-scroll"><button class="tab-button active" data-category="transform"> <span class="tab-icon">ğŸ”„</span> <span class="tab-label">Ø§Ù„ØªØ­ÙˆÙŠÙ„</span> <span class="tab-count">9</span> </button> <button class="tab-button" data-category="lighting"> <span class="tab-icon">ğŸ’¡</span> <span class="tab-label">Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø©</span> <span class="tab-count">10</span> </button> <button class="tab-button" data-category="sharpness"> <span class="tab-icon">ğŸ”</span> <span class="tab-label">Ø§Ù„ØªÙˆØ¶ÙŠØ­</span> <span class="tab-count">5</span> </button> <button class="tab-button" data-category="filters"> <span class="tab-icon">ğŸ­</span> <span class="tab-label">Ø§Ù„ÙÙ„Ø§ØªØ±</span> <span class="tab-count">15</span> </button> <button class="tab-button" data-category="artistic"> <span class="tab-icon">ğŸ–Œï¸</span> <span class="tab-label">ÙÙ†ÙŠ</span> <span class="tab-count">8</span> </button> <button class="tab-button" data-category="effects"> <span class="tab-icon">âœ¨</span> <span class="tab-label">ØªØ£Ø«ÙŠØ±Ø§Øª</span> <span class="tab-count">3</span> </button>
      </div>
     </div><!-- Tools Content -->
     <div class="tools-content"><!-- Transform Tools -->
      <div class="tools-panel active" data-panel="transform">
       <div class="tools-scroll"><button class="tool-button disabled" data-tool="rotate" data-icon="ğŸ”„" data-label="ØªØ¯ÙˆÙŠØ±"> <span class="tool-icon">ğŸ”„</span> <span>ØªØ¯ÙˆÙŠØ±</span> </button> <button class="tool-button disabled" data-tool="fliph" data-icon="â†”ï¸" data-label="Ù‚Ù„Ø¨ Ø£ÙÙ‚ÙŠ"> <span class="tool-icon">â†”ï¸</span> <span>Ù‚Ù„Ø¨ Ø£ÙÙ‚ÙŠ</span> </button> <button class="tool-button disabled" data-tool="flipv" data-icon="â†•ï¸" data-label="Ù‚Ù„Ø¨ Ø¹Ù…ÙˆØ¯ÙŠ"> <span class="tool-icon">â†•ï¸</span> <span>Ù‚Ù„Ø¨ Ø¹Ù…ÙˆØ¯ÙŠ</span> </button> <button class="tool-button disabled" data-tool="mirror" data-icon="ğŸª" data-label="Ù…Ø±Ø¢Ø©"> <span class="tool-icon">ğŸª</span> <span>Ù…Ø±Ø¢Ø©</span> </button> <button class="tool-button disabled" data-tool="kaleidoscope" data-icon="ğŸ”®" data-label="ÙƒØ§Ù„ÙŠØ¯ÙˆØ³ÙƒÙˆØ¨"> <span class="tool-icon">ğŸ”®</span> <span>ÙƒØ§Ù„ÙŠØ¯ÙˆØ³ÙƒÙˆØ¨</span> </button> <button class="tool-button disabled" data-tool="fisheye" data-icon="ğŸŸ" data-label="Ø¹ÙŠÙ† Ø§Ù„Ø³Ù…ÙƒØ©"> <span class="tool-icon">ğŸŸ</span> <span>Ø¹ÙŠÙ† Ø§Ù„Ø³Ù…ÙƒØ©</span> </button> <button class="tool-button disabled" data-tool="bulge" data-icon="ğŸˆ" data-label="Ø§Ù†ØªÙØ§Ø®"> <span class="tool-icon">ğŸˆ</span> <span>Ø§Ù†ØªÙØ§Ø®</span> </button> <button class="tool-button disabled" data-tool="pinch" data-icon="ğŸ¤" data-label="Ù‚Ø±Øµ"> <span class="tool-icon">ğŸ¤</span> <span>Ù‚Ø±Øµ</span> </button> <button class="tool-button disabled" data-tool="swirl" data-icon="ğŸŒ€" data-label="Ø¯ÙˆØ§Ù…Ø©"> <span class="tool-icon">ğŸŒ€</span> <span>Ø¯ÙˆØ§Ù…Ø©</span> </button>
       </div>
      </div><!-- Lighting & Color Tools -->
      <div class="tools-panel" data-panel="lighting">
       <div class="tools-scroll"><button class="tool-button disabled" data-tool="brightness" data-icon="â˜€ï¸" data-label="Ø§Ù„Ø³Ø·ÙˆØ¹"> <span class="tool-icon">â˜€ï¸</span> <span id="brightnessText">Ø§Ù„Ø³Ø·ÙˆØ¹</span> </button> <button class="tool-button disabled" data-tool="contrast" data-icon="â—" data-label="Ø§Ù„ØªØ¨Ø§ÙŠÙ†"> <span class="tool-icon">â—</span> <span id="contrastText">Ø§Ù„ØªØ¨Ø§ÙŠÙ†</span> </button> <button class="tool-button disabled" data-tool="saturation" data-icon="ğŸŒˆ" data-label="Ø§Ù„ØªØ´Ø¨Ø¹"> <span class="tool-icon">ğŸŒˆ</span> <span id="saturationText">Ø§Ù„ØªØ´Ø¨Ø¹</span> </button> <button class="tool-button disabled" data-tool="hue" data-icon="ğŸ¨" data-label="ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù„ÙˆÙ†"> <span class="tool-icon">ğŸ¨</span> <span>ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù„ÙˆÙ†</span> </button> <button class="tool-button disabled" data-tool="temperature" data-icon="ğŸŒ¡ï¸" data-label="Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©"> <span class="tool-icon">ğŸŒ¡ï¸</span> <span>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</span> </button> <button class="tool-button disabled" data-tool="tint" data-icon="ğŸ’§" data-label="Ø§Ù„ØµØ¨ØºØ©"> <span class="tool-icon">ğŸ’§</span> <span>Ø§Ù„ØµØ¨ØºØ©</span> </button> <button class="tool-button disabled" data-tool="exposure" data-icon="ğŸ“¸" data-label="Ø§Ù„ØªØ¹Ø±ÙŠØ¶"> <span class="tool-icon">ğŸ“¸</span> <span>Ø§Ù„ØªØ¹Ø±ÙŠØ¶</span> </button> <button class="tool-button disabled" data-tool="highlights" data-icon="ğŸ’¡" data-label="Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø§Øª"> <span class="tool-icon">ğŸ’¡</span> <span>Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø§Øª</span> </button> <button class="tool-button disabled" data-tool="shadows" data-icon="ğŸŒ‘" data-label="Ø§Ù„Ø¸Ù„Ø§Ù„"> <span class="tool-icon">ğŸŒ‘</span> <span>Ø§Ù„Ø¸Ù„Ø§Ù„</span> </button> <button class="tool-button disabled" data-tool="vibrance" data-icon="âœ¨" data-label="Ø§Ù„Ø­ÙŠÙˆÙŠØ©"> <span class="tool-icon">âœ¨</span> <span>Ø§Ù„Ø­ÙŠÙˆÙŠØ©</span> </button>
       </div>
      </div><!-- Sharpness Tools -->
      <div class="tools-panel" data-panel="sharpness">
       <div class="tools-scroll"><button class="tool-button disabled" data-tool="sharpen" data-icon="ğŸ”" data-label="Ø§Ù„ØªÙˆØ¶ÙŠØ­"> <span class="tool-icon">ğŸ”</span> <span>Ø§Ù„ØªÙˆØ¶ÙŠØ­</span> </button> <button class="tool-button disabled" data-tool="blur" data-icon="ğŸ’«" data-label="Ø§Ù„Ø¶Ø¨Ø§Ø¨ÙŠØ©"> <span class="tool-icon">ğŸ’«</span> <span>Ø§Ù„Ø¶Ø¨Ø§Ø¨ÙŠØ©</span> </button> <button class="tool-button disabled" data-tool="noise" data-icon="ğŸ“¡" data-label="ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙˆÙŠØ´"> <span class="tool-icon">ğŸ“¡</span> <span>ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙˆÙŠØ´</span> </button> <button class="tool-button disabled" data-tool="clarity" data-icon="ğŸ’" data-label="Ø§Ù„ÙˆØ¶ÙˆØ­"> <span class="tool-icon">ğŸ’</span> <span>Ø§Ù„ÙˆØ¶ÙˆØ­</span> </button> <button class="tool-button disabled" data-tool="enhancedclarity" data-icon="ğŸ’ " data-label="Ø§Ù„ÙˆØ¶ÙˆØ­ Ø§Ù„Ù…Ø­Ø³Ù‘Ù†"> <span class="tool-icon">ğŸ’ </span> <span>Ø§Ù„ÙˆØ¶ÙˆØ­ Ø§Ù„Ù…Ø­Ø³Ù‘Ù†</span> </button>
       </div>
      </div><!-- Professional Filters -->
      <div class="tools-panel" data-panel="filters">
       <div class="tools-scroll"><button class="tool-button disabled" data-tool="grayscale" data-icon="âš«" data-label="Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯"> <span class="tool-icon">âš«</span> <span>Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯</span> </button> <button class="tool-button disabled" data-tool="sepia" data-icon="ğŸŸ¤" data-label="Ø³ÙŠØ¨ÙŠØ§"> <span class="tool-icon">ğŸŸ¤</span> <span>Ø³ÙŠØ¨ÙŠØ§</span> </button> <button class="tool-button disabled" data-tool="invert" data-icon="ğŸ”„" data-label="Ø¹ÙƒØ³ Ø§Ù„Ø£Ù„ÙˆØ§Ù†"> <span class="tool-icon">ğŸ”„</span> <span>Ø¹ÙƒØ³ Ø§Ù„Ø£Ù„ÙˆØ§Ù†</span> </button> <button class="tool-button disabled" data-tool="vintage" data-icon="ğŸ“·" data-label="ÙÙŠÙ†ØªØ§Ø¬"> <span class="tool-icon">ğŸ“·</span> <span>ÙÙŠÙ†ØªØ§Ø¬</span> </button> <button class="tool-button disabled" data-tool="warm" data-icon="ğŸ”¥" data-label="Ø¯Ø§ÙØ¦"> <span class="tool-icon">ğŸ”¥</span> <span>Ø¯Ø§ÙØ¦</span> </button> <button class="tool-button disabled" data-tool="cool" data-icon="â„ï¸" data-label="Ø¨Ø§Ø±Ø¯"> <span class="tool-icon">â„ï¸</span> <span>Ø¨Ø§Ø±Ø¯</span> </button> <button class="tool-button disabled" data-tool="dramatic" data-icon="ğŸ­" data-label="Ø¯Ø±Ø§Ù…ÙŠ"> <span class="tool-icon">ğŸ­</span> <span>Ø¯Ø±Ø§Ù…ÙŠ</span> </button> <button class="tool-button disabled" data-tool="vivid" data-icon="ğŸŒº" data-label="Ø­ÙŠÙˆÙŠ"> <span class="tool-icon">ğŸŒº</span> <span>Ø­ÙŠÙˆÙŠ</span> </button> <button class="tool-button disabled" data-tool="soft" data-icon="ğŸŒ¸" data-label="Ù†Ø§Ø¹Ù…"> <span class="tool-icon">ğŸŒ¸</span> <span>Ù†Ø§Ø¹Ù…</span> </button> <button class="tool-button disabled" data-tool="hdr" data-icon="ğŸŒ…" data-label="HDR"> <span class="tool-icon">ğŸŒ…</span> <span>HDR</span> </button> <button class="tool-button disabled" data-tool="neon" data-icon="ğŸ’¡" data-label="Ù†ÙŠÙˆÙ†"> <span class="tool-icon">ğŸ’¡</span> <span>Ù†ÙŠÙˆÙ†</span> </button> <button class="tool-button disabled" data-tool="vignette" data-icon="â­•" data-label="ÙÙŠÙ†ÙŠÙŠØª"> <span class="tool-icon">â­•</span> <span>ÙÙŠÙ†ÙŠÙŠØª</span> </button> <button class="tool-button disabled" data-tool="grain" data-icon="ğŸŒ¾" data-label="Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙÙŠÙ„Ù…"> <span class="tool-icon">ğŸŒ¾</span> <span>Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙÙŠÙ„Ù…</span> </button> <button class="tool-button disabled" data-tool="fade" data-icon="ğŸŒ«ï¸" data-label="Ø¨Ù‡ØªØ§Ù†"> <span class="tool-icon">ğŸŒ«ï¸</span> <span>Ø¨Ù‡ØªØ§Ù†</span> </button> <button class="tool-button disabled" data-tool="glow" data-icon="âœ¨" data-label="ØªÙˆÙ‡Ø¬"> <span class="tool-icon">âœ¨</span> <span>ØªÙˆÙ‡Ø¬</span> </button>
       </div>
      </div><!-- Artistic Effects -->
      <div class="tools-panel" data-panel="artistic">
       <div class="tools-scroll"><button class="tool-button disabled" data-tool="posterize" data-icon="ğŸ¨" data-label="Ø¨ÙˆØ³ØªØ±"> <span class="tool-icon">ğŸ¨</span> <span>Ø¨ÙˆØ³ØªØ±</span> </button> <button class="tool-button disabled" data-tool="pixelate" data-icon="ğŸŸ¦" data-label="Ø¨ÙƒØ³Ù„"> <span class="tool-icon">ğŸŸ¦</span> <span>Ø¨ÙƒØ³Ù„</span> </button> <button class="tool-button disabled" data-tool="emboss" data-icon="ğŸ—¿" data-label="Ù†Ù‚Ø´ Ø¨Ø§Ø±Ø²"> <span class="tool-icon">ğŸ—¿</span> <span>Ù†Ù‚Ø´ Ø¨Ø§Ø±Ø²</span> </button> <button class="tool-button disabled" data-tool="edge" data-icon="ğŸ“" data-label="ÙƒØ´Ù Ø§Ù„Ø­ÙˆØ§Ù"> <span class="tool-icon">ğŸ“</span> <span>ÙƒØ´Ù Ø§Ù„Ø­ÙˆØ§Ù</span> </button> <button class="tool-button disabled" data-tool="sketch" data-icon="âœï¸" data-label="Ø±Ø³Ù…"> <span class="tool-icon">âœï¸</span> <span>Ø±Ø³Ù…</span> </button> <button class="tool-button disabled" data-tool="cartoon" data-icon="ğŸ¬" data-label="ÙƒØ±ØªÙˆÙ†"> <span class="tool-icon">ğŸ¬</span> <span>ÙƒØ±ØªÙˆÙ†</span> </button> <button class="tool-button disabled" data-tool="oil" data-icon="ğŸ–Œï¸" data-label="Ø±Ø³Ù… Ø²ÙŠØªÙŠ"> <span class="tool-icon">ğŸ–Œï¸</span> <span>Ø±Ø³Ù… Ø²ÙŠØªÙŠ</span> </button> <button class="tool-button disabled" data-tool="watercolor" data-icon="ğŸ¨" data-label="Ø£Ù„ÙˆØ§Ù† Ù…Ø§Ø¦ÙŠØ©"> <span class="tool-icon">ğŸ¨</span> <span>Ø£Ù„ÙˆØ§Ù† Ù…Ø§Ø¦ÙŠØ©</span> </button>
       </div>
      </div><!-- Additional Effects -->
      <div class="tools-panel" data-panel="effects">
       <div class="tools-scroll"><button class="tool-button disabled" data-tool="shadow" data-icon="ğŸŒ“" data-label="Ø¸Ù„"> <span class="tool-icon">ğŸŒ“</span> <span>Ø¸Ù„</span> </button> <button class="tool-button disabled" data-tool="frame" data-icon="ğŸ–¼ï¸" data-label="Ø¥Ø·Ø§Ø±"> <span class="tool-icon">ğŸ–¼ï¸</span> <span>Ø¥Ø·Ø§Ø±</span> </button> <button class="tool-button disabled" data-tool="gloweffect" data-icon="ğŸŒŸ" data-label="ØªÙˆÙ‡Ø¬ Ù…Ø­Ø³Ù‘Ù†"> <span class="tool-icon">ğŸŒŸ</span> <span>ØªÙˆÙ‡Ø¬ Ù…Ø­Ø³Ù‘Ù†</span> </button>
       </div>
      </div>
     </div><!-- Action Buttons -->
     <div class="action-buttons"><button class="action-button btn-reset-all disabled" id="resetAllButton"> <span>ğŸ”„</span> <span>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒÙ„</span> </button> <button class="action-button btn-save disabled" id="saveButton"> <span>ğŸ’¾</span> <span id="saveText">Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©</span> </button> <button class="action-button btn-share disabled" id="shareButton"> <span>ğŸ“¤</span> <span>Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØµÙˆØ±Ø©</span> </button>
     </div>
    </section>
   </main>
  </div><!-- Control Panel -->
  <div class="control-panel" id="controlPanel">
   <div class="control-header">
    <div class="control-title"><span id="controlIcon">ğŸ¨</span> <span id="controlToolName">Ø£Ø¯Ø§Ø© Ø§Ù„ØªØ­Ø±ÙŠØ±</span>
    </div><button class="close-control" id="closeControl">âœ•</button>
   </div>
   <div class="control-content" id="controlContent"><!-- Sliders will be dynamically added here -->
   </div>
  </div><!-- Toast Notification -->
  <div class="toast" id="toast"></div>
  <script>
        const defaultConfig = {
            app_title: "Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ",
            upload_button_text: "Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù„Ù„Ø¨Ø¯Ø¡",
            brightness_text: "Ø§Ù„Ø³Ø·ÙˆØ¹",
            contrast_text: "Ø§Ù„ØªØ¨Ø§ÙŠÙ†",
            saturation_text: "Ø§Ù„ØªØ´Ø¨Ø¹",
            save_text: "Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©",
            primary_color: "#667eea",
            font_family: "Segoe UI",
            font_size: 16
        };

        let currentImage = null;
        let originalImageData = null;
        let imageFilters = {
            // Transform
            rotate: 0, fliph: 1, flipv: 1, mirror: 0, kaleidoscope: 0, fisheye: 0, bulge: 0, pinch: 0, swirl: 0,
            // Lighting & Color
            brightness: 100, contrast: 100, saturation: 100, hue: 0, temperature: 0, tint: 0, exposure: 0, highlights: 0, shadows: 0, vibrance: 0,
            // Sharpness
            sharpen: 0, blur: 0, noise: 0, clarity: 0, enhancedclarity: 0,
            // Filters
            grayscale: 0, sepia: 0, invert: 0, vintage: 0, warm: 0, cool: 0, dramatic: 0, vivid: 0, soft: 0, hdr: 0, neon: 0, vignette: 0, grain: 0, fade: 0, glow: 0,
            // Artistic
            posterize: 0, pixelate: 0, emboss: 0, edge: 0, sketch: 0, cartoon: 0, oil: 0, watercolor: 0,
            // Additional
            shadow: 0, frame: 0, gloweffect: 0
        };

        let currentTool = null;

        const elements = {
            appTitle: document.getElementById('appTitle'),
            uploadButton: document.getElementById('uploadButton'),
            uploadButtonText: document.getElementById('uploadButtonText'),
            fileInput: document.getElementById('fileInput'),
            imageDisplay: document.getElementById('imageDisplay'),
            resetAllButton: document.getElementById('resetAllButton'),
            saveButton: document.getElementById('saveButton'),
            shareButton: document.getElementById('shareButton'),
            toast: document.getElementById('toast'),
            brightnessText: document.getElementById('brightnessText'),
            contrastText: document.getElementById('contrastText'),
            saturationText: document.getElementById('saturationText'),
            saveText: document.getElementById('saveText'),
            controlPanel: document.getElementById('controlPanel'),
            closeControl: document.getElementById('closeControl'),
            controlContent: document.getElementById('controlContent'),
            controlToolName: document.getElementById('controlToolName'),
            controlIcon: document.getElementById('controlIcon'),
            effectCanvas: document.getElementById('effectCanvas')
        };

        const toolConfigs = {
            // Transform Tools
            rotate: { min: 0, max: 360, default: 0, unit: 'Â°', label: 'ØªØ¯ÙˆÙŠØ±' },
            fliph: { min: -1, max: 1, default: 1, unit: '', label: 'Ù‚Ù„Ø¨ Ø£ÙÙ‚ÙŠ', step: 2 },
            flipv: { min: -1, max: 1, default: 1, unit: '', label: 'Ù‚Ù„Ø¨ Ø¹Ù…ÙˆØ¯ÙŠ', step: 2 },
            mirror: { min: 0, max: 100, default: 0, unit: '%', label: 'Ù…Ø±Ø¢Ø©' },
            kaleidoscope: { min: 0, max: 12, default: 0, unit: '', label: 'ÙƒØ§Ù„ÙŠØ¯ÙˆØ³ÙƒÙˆØ¨' },
            fisheye: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¹ÙŠÙ† Ø§Ù„Ø³Ù…ÙƒØ©' },
            bulge: { min: -100, max: 100, default: 0, unit: '%', label: 'Ø§Ù†ØªÙØ§Ø®' },
            pinch: { min: -100, max: 100, default: 0, unit: '%', label: 'Ù‚Ø±Øµ' },
            swirl: { min: -360, max: 360, default: 0, unit: 'Â°', label: 'Ø¯ÙˆØ§Ù…Ø©' },
            
            // Lighting & Color
            brightness: { min: 0, max: 200, default: 100, unit: '%', label: 'Ø§Ù„Ø³Ø·ÙˆØ¹' },
            contrast: { min: 0, max: 200, default: 100, unit: '%', label: 'Ø§Ù„ØªØ¨Ø§ÙŠÙ†' },
            saturation: { min: 0, max: 200, default: 100, unit: '%', label: 'Ø§Ù„ØªØ´Ø¨Ø¹' },
            hue: { min: 0, max: 360, default: 0, unit: 'Â°', label: 'ØªØ¯ÙˆÙŠØ± Ø§Ù„Ù„ÙˆÙ†' },
            temperature: { min: -100, max: 100, default: 0, unit: '', label: 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©' },
            tint: { min: -100, max: 100, default: 0, unit: '', label: 'Ø§Ù„ØµØ¨ØºØ©' },
            exposure: { min: -100, max: 100, default: 0, unit: '', label: 'Ø§Ù„ØªØ¹Ø±ÙŠØ¶' },
            highlights: { min: -100, max: 100, default: 0, unit: '', label: 'Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø§Øª' },
            shadows: { min: -100, max: 100, default: 0, unit: '', label: 'Ø§Ù„Ø¸Ù„Ø§Ù„' },
            vibrance: { min: 0, max: 200, default: 0, unit: '%', label: 'Ø§Ù„Ø­ÙŠÙˆÙŠØ©' },
            
            // Sharpness
            sharpen: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø§Ù„ØªÙˆØ¶ÙŠØ­' },
            blur: { min: 0, max: 20, default: 0, unit: 'px', label: 'Ø§Ù„Ø¶Ø¨Ø§Ø¨ÙŠØ©' },
            noise: { min: 0, max: 100, default: 0, unit: '%', label: 'ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªØ´ÙˆÙŠØ´' },
            clarity: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø§Ù„ÙˆØ¶ÙˆØ­' },
            enhancedclarity: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø§Ù„ÙˆØ¶ÙˆØ­ Ø§Ù„Ù…Ø­Ø³Ù‘Ù†' },
            
            // Filters
            grayscale: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø£Ø¨ÙŠØ¶ ÙˆØ£Ø³ÙˆØ¯' },
            sepia: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø³ÙŠØ¨ÙŠØ§' },
            invert: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¹ÙƒØ³ Ø§Ù„Ø£Ù„ÙˆØ§Ù†' },
            vintage: { min: 0, max: 100, default: 0, unit: '%', label: 'ÙÙŠÙ†ØªØ§Ø¬' },
            warm: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¯Ø§ÙØ¦' },
            cool: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¨Ø§Ø±Ø¯' },
            dramatic: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¯Ø±Ø§Ù…ÙŠ' },
            vivid: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø­ÙŠÙˆÙŠ' },
            soft: { min: 0, max: 100, default: 0, unit: '%', label: 'Ù†Ø§Ø¹Ù…' },
            hdr: { min: 0, max: 100, default: 0, unit: '%', label: 'HDR' },
            neon: { min: 0, max: 100, default: 0, unit: '%', label: 'Ù†ÙŠÙˆÙ†' },
            vignette: { min: 0, max: 100, default: 0, unit: '%', label: 'ÙÙŠÙ†ÙŠÙŠØª' },
            grain: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø­Ø¨ÙŠØ¨Ø§Øª Ø§Ù„ÙÙŠÙ„Ù…' },
            fade: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¨Ù‡ØªØ§Ù†' },
            glow: { min: 0, max: 100, default: 0, unit: '%', label: 'ØªÙˆÙ‡Ø¬' },
            
            // Artistic
            posterize: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¨ÙˆØ³ØªØ±' },
            pixelate: { min: 0, max: 20, default: 0, unit: 'px', label: 'Ø¨ÙƒØ³Ù„' },
            emboss: { min: 0, max: 100, default: 0, unit: '%', label: 'Ù†Ù‚Ø´ Ø¨Ø§Ø±Ø²' },
            edge: { min: 0, max: 100, default: 0, unit: '%', label: 'ÙƒØ´Ù Ø§Ù„Ø­ÙˆØ§Ù' },
            sketch: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø±Ø³Ù…' },
            cartoon: { min: 0, max: 100, default: 0, unit: '%', label: 'ÙƒØ±ØªÙˆÙ†' },
            oil: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø±Ø³Ù… Ø²ÙŠØªÙŠ' },
            watercolor: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø£Ù„ÙˆØ§Ù† Ù…Ø§Ø¦ÙŠØ©' },
            
            // Additional
            shadow: { min: 0, max: 100, default: 0, unit: '%', label: 'Ø¸Ù„' },
            frame: { min: 0, max: 50, default: 0, unit: 'px', label: 'Ø¥Ø·Ø§Ø±' },
            gloweffect: { min: 0, max: 100, default: 0, unit: '%', label: 'ØªÙˆÙ‡Ø¬ Ù…Ø­Ø³Ù‘Ù†' }
        };

        async function onConfigChange(config) {
            const finalConfig = { ...defaultConfig, ...config };
            
            elements.appTitle.textContent = finalConfig.app_title;
            elements.uploadButtonText.textContent = finalConfig.upload_button_text;
            elements.brightnessText.textContent = finalConfig.brightness_text;
            elements.contrastText.textContent = finalConfig.contrast_text;
            elements.saturationText.textContent = finalConfig.saturation_text;
            elements.saveText.textContent = finalConfig.save_text;

            const baseSize = finalConfig.font_size;
            const customFont = finalConfig.font_family;
            const fontStack = `${customFont}, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`;
            
            document.body.style.fontFamily = fontStack;
            elements.appTitle.style.fontSize = `${baseSize * 2.25}px`;
            elements.uploadButton.style.fontSize = `${baseSize * 1.25}px`;
            
            document.querySelectorAll('.tool-button').forEach(btn => {
                btn.style.fontSize = `${baseSize * 0.875}px`;
            });
            
            document.querySelectorAll('.action-button').forEach(btn => {
                btn.style.fontSize = `${baseSize}px`;
            });

            const primaryColor = finalConfig.primary_color;
            document.documentElement.style.setProperty('--primary-color', primaryColor);
        }

        function mapToCapabilities(config) {
            return {
                recolorables: [
                    {
                        get: () => config.primary_color || defaultConfig.primary_color,
                        set: (value) => {
                            if (window.elementSdk) {
                                window.elementSdk.setConfig({ primary_color: value });
                            }
                        }
                    }
                ],
                borderables: [],
                fontEditable: {
                    get: () => config.font_family || defaultConfig.font_family,
                    set: (value) => {
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_family: value });
                        }
                    }
                },
                fontSizeable: {
                    get: () => config.font_size || defaultConfig.font_size,
                    set: (value) => {
                        if (window.elementSdk) {
                            window.elementSdk.setConfig({ font_size: value });
                        }
                    }
                }
            };
        }

        function mapToEditPanelValues(config) {
            const finalConfig = { ...defaultConfig, ...config };
            return new Map([
                ["app_title", finalConfig.app_title],
                ["upload_button_text", finalConfig.upload_button_text],
                ["brightness_text", finalConfig.brightness_text],
                ["contrast_text", finalConfig.contrast_text],
                ["saturation_text", finalConfig.saturation_text],
                ["save_text", finalConfig.save_text]
            ]);
        }

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig,
                onConfigChange,
                mapToCapabilities,
                mapToEditPanelValues
            });
        }

        function showToast(message) {
            elements.toast.textContent = message;
            elements.toast.classList.add('show');
            setTimeout(() => {
                elements.toast.classList.remove('show');
            }, 3000);
        }

        function enableTools() {
            document.querySelectorAll('.tool-button').forEach(btn => btn.classList.remove('disabled'));
            elements.saveButton.classList.remove('disabled');
            elements.shareButton.classList.remove('disabled');
            elements.resetAllButton.classList.remove('disabled');
        }

        // Tab switching functionality
        function initTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const toolsPanels = document.querySelectorAll('.tools-panel');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const category = button.dataset.category;
                    
                    // Update active tab
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    
                    // Update active panel
                    toolsPanels.forEach(panel => panel.classList.remove('active'));
                    const activePanel = document.querySelector(`[data-panel="${category}"]`);
                    if (activePanel) {
                        activePanel.classList.add('active');
                    }
                });
            });
        }

        function displayImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                currentImage = e.target.result;
                const img = new Image();
                img.onload = function() {
                    elements.effectCanvas.width = img.width;
                    elements.effectCanvas.height = img.height;
                    const ctx = elements.effectCanvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    originalImageData = ctx.getImageData(0, 0, img.width, img.height);
                };
                img.src = currentImage;
                
                elements.imageDisplay.innerHTML = `<img src="${currentImage}" alt="Selected photo" id="displayedImage">`;
                elements.imageDisplay.classList.add('has-image');
                enableTools();
                showToast('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!');
            };
            reader.readAsDataURL(file);
        }

        function openControlPanel(tool, icon, label) {
            currentTool = tool;
            elements.controlIcon.textContent = icon;
            elements.controlToolName.textContent = label;
            
            const config = toolConfigs[tool];
            const currentValue = imageFilters[tool];
            
            elements.controlContent.innerHTML = `
                <div class="slider-container">
                    <div class="slider-label">
                        <span>${config.label}</span>
                        <span class="slider-value" id="sliderValue">${currentValue}${config.unit}</span>
                    </div>
                    <input type="range" class="slider" id="toolSlider" 
                           min="${config.min}" max="${config.max}" value="${currentValue}" ${config.step ? `step="${config.step}"` : ''}>
                </div>
                <div class="control-buttons">
                    <button class="control-btn btn-reset" id="resetBtn">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
            `;
            
            const slider = document.getElementById('toolSlider');
            const sliderValue = document.getElementById('sliderValue');
            const resetBtn = document.getElementById('resetBtn');
            
            slider.addEventListener('input', (e) => {
                let value = parseFloat(e.target.value);
                
                if (tool === 'fliph' || tool === 'flipv') {
                    sliderValue.textContent = value === 1 ? 'Ø¹Ø§Ø¯ÙŠ' : 'Ù…Ù‚Ù„ÙˆØ¨';
                } else {
                    sliderValue.textContent = `${value}${config.unit}`;
                }
                
                imageFilters[tool] = value;
                applyFilters();
            });
            
            resetBtn.addEventListener('click', () => {
                imageFilters[tool] = config.default;
                slider.value = config.default;
                if (tool === 'fliph' || tool === 'flipv') {
                    sliderValue.textContent = config.default === 1 ? 'Ø¹Ø§Ø¯ÙŠ' : 'Ù…Ù‚Ù„ÙˆØ¨';
                } else {
                    sliderValue.textContent = `${config.default}${config.unit}`;
                }
                applyFilters();
                showToast('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†');
            });
            
            elements.controlPanel.classList.add('active');
        }

        function closeControlPanel() {
            elements.controlPanel.classList.remove('active');
            document.querySelectorAll('.tool-button').forEach(btn => btn.classList.remove('active'));
        }

        function applyFilters() {
            const img = document.getElementById('displayedImage');
            if (!img) return;
            
            // Calculate combined values
            let brightness = imageFilters.brightness + (imageFilters.exposure * 0.5) + (imageFilters.highlights * 0.3);
            let contrast = imageFilters.contrast + (imageFilters.sharpen * 0.5) + (imageFilters.clarity * 0.3) + (imageFilters.enhancedclarity * 0.5);
            let saturation = imageFilters.saturation + (imageFilters.vibrance * 0.5);
            let hue = imageFilters.hue + (imageFilters.temperature * 0.3) + (imageFilters.tint * 0.2);
            
            // Apply filter presets
            if (imageFilters.vintage > 0) {
                const amount = imageFilters.vintage / 100;
                imageFilters.sepia = Math.min(100, 60 * amount);
                contrast = contrast * (1 - 0.1 * amount);
                brightness = brightness * (1 + 0.1 * amount);
            }
            
            if (imageFilters.warm > 0) {
                const amount = imageFilters.warm / 100;
                hue += 20 * amount;
                saturation = saturation * (1 + 0.2 * amount);
            }
            
            if (imageFilters.cool > 0) {
                const amount = imageFilters.cool / 100;
                hue -= 20 * amount;
                saturation = saturation * (1 + 0.1 * amount);
            }
            
            if (imageFilters.dramatic > 0) {
                const amount = imageFilters.dramatic / 100;
                contrast = contrast * (1 + 0.5 * amount);
                saturation = saturation * (1 + 0.3 * amount);
                brightness = brightness * (1 - 0.1 * amount);
            }
            
            if (imageFilters.vivid > 0) {
                const amount = imageFilters.vivid / 100;
                saturation = saturation * (1 + 0.6 * amount);
                contrast = contrast * (1 + 0.2 * amount);
            }
            
            if (imageFilters.soft > 0) {
                const amount = imageFilters.soft / 100;
                brightness = brightness * (1 + 0.1 * amount);
                contrast = contrast * (1 - 0.1 * amount);
            }
            
            if (imageFilters.hdr > 0) {
                const amount = imageFilters.hdr / 100;
                contrast = contrast * (1 + 0.4 * amount);
                saturation = saturation * (1 + 0.3 * amount);
                brightness = brightness * (1 + 0.05 * amount);
            }
            
            if (imageFilters.neon > 0) {
                const amount = imageFilters.neon / 100;
                saturation = saturation * (1 + amount);
                contrast = contrast * (1 + 0.5 * amount);
                brightness = brightness * (1 + 0.2 * amount);
            }
            
            // Build filter string
            let filterString = `
                brightness(${brightness}%)
                contrast(${contrast}%)
                saturate(${saturation}%)
                hue-rotate(${hue}deg)
                blur(${imageFilters.blur + (imageFilters.soft * 0.01)}px)
                sepia(${imageFilters.sepia}%)
                grayscale(${imageFilters.grayscale}%)
                invert(${imageFilters.invert}%)
            `;
            
            img.style.filter = filterString;
            
            // Apply transform with distortion effects
            let transformString = `rotate(${imageFilters.rotate}deg)`;
            
            // Apply flip
            const scaleX = imageFilters.fliph;
            const scaleY = imageFilters.flipv;
            transformString += ` scaleX(${scaleX}) scaleY(${scaleY})`;
            
            // Apply perspective effects for fisheye, bulge, pinch
            if (imageFilters.fisheye > 0) {
                const fisheyeAmount = 1 + (imageFilters.fisheye / 100);
                transformString += ` perspective(${500 / fisheyeAmount}px)`;
            }
            
            if (imageFilters.bulge !== 0) {
                const bulgeAmount = 1 + (imageFilters.bulge / 200);
                transformString += ` scale(${bulgeAmount})`;
            }
            
            if (imageFilters.pinch !== 0) {
                const pinchAmount = 1 - (imageFilters.pinch / 200);
                transformString += ` scale(${pinchAmount})`;
            }
            
            // Apply swirl rotation
            if (imageFilters.swirl !== 0) {
                transformString += ` rotate(${imageFilters.swirl}deg)`;
            }
            
            img.style.transform = transformString;
            
            // Apply mirror effect
            if (imageFilters.mirror > 0) {
                const mirrorAmount = imageFilters.mirror / 100;
                img.style.clipPath = `polygon(${50 - mirrorAmount * 50}% 0%, ${50 + mirrorAmount * 50}% 0%, ${50 + mirrorAmount * 50}% 100%, ${50 - mirrorAmount * 50}% 100%)`;
            } else {
                img.style.clipPath = 'none';
            }
            
            // Apply kaleidoscope effect (simulated with multiple reflections)
            if (imageFilters.kaleidoscope > 0) {
                const segments = Math.floor(imageFilters.kaleidoscope);
                if (segments > 0) {
                    const angle = 360 / segments;
                    img.style.filter += ` hue-rotate(${angle}deg)`;
                }
            }
            
            // Apply effects
            let boxShadow = '';
            
            if (imageFilters.vignette > 0) {
                const vignetteAmount = imageFilters.vignette / 100;
                boxShadow += `inset 0 0 ${100 * vignetteAmount}px ${50 * vignetteAmount}px rgba(0,0,0,${0.5 * vignetteAmount})`;
            }
            
            if (imageFilters.shadow > 0) {
                const shadowAmount = imageFilters.shadow / 100;
                if (boxShadow) boxShadow += ', ';
                boxShadow += `0 ${20 * shadowAmount}px ${40 * shadowAmount}px rgba(0,0,0,${0.5 * shadowAmount})`;
            }
            
            if (imageFilters.glow > 0 || imageFilters.gloweffect > 0) {
                const glowAmount = (imageFilters.glow + imageFilters.gloweffect) / 100;
                if (boxShadow) boxShadow += ', ';
                boxShadow += `0 0 ${30 * glowAmount}px ${15 * glowAmount}px rgba(255,255,255,${0.8 * glowAmount})`;
            }
            
            img.style.boxShadow = boxShadow;
            
            // Apply frame
            if (imageFilters.frame > 0) {
                img.style.border = `${imageFilters.frame}px solid #fff`;
                img.style.outline = `${imageFilters.frame / 2}px solid #333`;
            } else {
                img.style.border = 'none';
                img.style.outline = 'none';
            }
            
            // Apply opacity for fade
            if (imageFilters.fade > 0) {
                img.style.opacity = 1 - (imageFilters.fade / 200);
            } else {
                img.style.opacity = 1;
            }
            
            // Apply grain effect
            if (imageFilters.grain > 0) {
                const grainAmount = imageFilters.grain / 100;
                img.style.filter += ` contrast(${100 + grainAmount * 10}%)`;
            }
        }

        // Initialize tabs
        initTabs();

        elements.uploadButton.addEventListener('click', () => {
            elements.fileInput.click();
        });

        elements.fileInput.addEventListener('change', (e) => {
            if (e.target.files && e.target.files[0]) {
                displayImage(e.target.files[0]);
            }
        });

        // Tool button click handlers (delegated to handle dynamically loaded buttons)
        document.addEventListener('click', (e) => {
            const button = e.target.closest('.tool-button');
            if (!button || button.classList.contains('disabled')) return;
            
            const tool = button.dataset.tool;
            const icon = button.dataset.icon;
            const label = button.dataset.label;
            
            // Close any open panel first
            const wasActive = button.classList.contains('active');
            document.querySelectorAll('.tool-button').forEach(btn => btn.classList.remove('active'));
            
            if (wasActive) {
                closeControlPanel();
            } else {
                button.classList.add('active');
                openControlPanel(tool, icon, label);
            }
        });

        elements.closeControl.addEventListener('click', closeControlPanel);

        elements.resetAllButton.addEventListener('click', () => {
            Object.keys(imageFilters).forEach(key => {
                const config = toolConfigs[key];
                if (config) {
                    imageFilters[key] = config.default;
                }
            });
            applyFilters();
            showToast('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª');
        });

        elements.saveButton.addEventListener('click', () => {
            if (!currentImage) return;
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = document.getElementById('displayedImage');
            
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.filter = img.style.filter;
            ctx.drawImage(img, 0, 0);
            
            const link = document.createElement('a');
            link.download = `edited_photo_${Date.now()}.png`;
            link.href = canvas.toDataURL();
            link.click();
            
            showToast('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­!');
        });

        elements.shareButton.addEventListener('click', async () => {
            if (!currentImage) return;
            
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            const img = document.getElementById('displayedImage');
            
            canvas.width = img.naturalWidth;
            canvas.height = img.naturalHeight;
            ctx.filter = img.style.filter;
            ctx.drawImage(img, 0, 0);
            
            canvas.toBlob(async (blob) => {
                const file = new File([blob], `edited_photo_${Date.now()}.png`, { type: 'image/png' });
                
                if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
                    try {
                        await navigator.share({
                            files: [file],
                            title: 'ØµÙˆØ±Ø© Ù…Ø¹Ø¯Ù„Ø©',
                            text: 'ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø­Ø±Ø± Ø§Ù„ØµÙˆØ± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ'
                        });
                        showToast('ğŸ“¤ ØªÙ…Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­!');
                    } catch (error) {
                        if (error.name !== 'AbortError') {
                            showToast('âŒ ÙØ´Ù„Øª Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©. Ø¬Ø±Ø¨ Ø§Ù„Ø­ÙØ¸ Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø°Ù„Ùƒ.');
                        }
                    }
                } else {
                    const link = document.createElement('a');
                    link.download = `edited_photo_${Date.now()}.png`;
                    link.href = canvas.toDataURL();
                    link.click();
                    showToast('ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø©! (Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­)');
                }
            }, 'image/png');
        });

        onConfigChange(defaultConfig);
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a9bef25643794b',t:'MTc2MjQ4NjE2Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
